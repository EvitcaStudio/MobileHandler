/**
 * mobile-handler@1.0.0 https://github.com/EvitcaStudio/MobileHandler
 * Compiled 1/25/2024, 5:04:02 PM UTC
 * 
 * mobile-handler is licensed under a MIT styled License. See LICENSE.md for more info.
 * 
 * Copyright 2024, Evitca Studio, All Rights Reserved
 */
 var t={d:(e,i)=>{for(var s in i)t.o(i,s)&&!t.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:i[s]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)},e={},i=(t.d(e,{g:()=>L}),{d:(t,e)=>{for(var s in e)i.o(e,s)&&!i.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)}),s={},o=(i.d(s,{c:()=>h}),{d:(t,e)=>{for(var i in e)o.o(e,i)&&!o.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)}),n={};o.d(n,{Y:()=>r});class r{constructor(t){this.RESET="[0m",this.BRIGHT="[1m",this.DIM="[2m",this.UNDERSCORE="[4m",this.BLINK="[5m",this.REVERSE="[7m",this.HIDDEN="[8m",this.FG_BLACK="[30m",this.FG_RED="[31m",this.FG_GREEN="[32m",this.FG_YELLOW="[33m",this.FG_BLUE="[34m",this.FG_MAGENTA="[35m",this.FG_CYAN="[36m",this.FG_WHITE="[37m",this.FG_GRAY="[90m",this.BG_BLACK="[40m",this.BG_RED="[41m",this.BG_GREEN="[42m",this.BG_YELLOW="[43m",this.BG_BLUE="[44m",this.BG_MAGENTA="[45m",this.BG_CYAN="[46m",this.BG_WHITE="[47m",this.BG_GRAY="[100m",this.TYPE_SPACER_LENGTH=13,this.types={default:this.FG_WHITE},this.currentType="",this.SPACE_CHAR=" ",this.FG_COLORS={};for(let t=0;t<=255;t++)this.FG_COLORS[t]="[38;5;"+t+"m";this.BG_COLORS={};for(let t=0;t<=255;t++)this.BG_COLORS[t]="[48;5;"+t+"m";Array.isArray(t)&&this.registerTypes(t)}prefix(t){return"string"==typeof t&&(this.currentType=t),this}message(e="log",...i){var s=this.currentType||"";if(0===s.length)console[e](...i);else{var o=s.length>=this.TYPE_SPACER_LENGTH;let t=this.types[s.toLowerCase()]?this.types[s.toLowerCase()]:this.types.default;var n=t.includes("");n||(t="color: "+t),!globalThis.window||n?console[e](t+s+this.SPACE_CHAR.repeat(Math.max(this.TYPE_SPACER_LENGTH-s.length,o?1:0))+"|"+this.RESET,...i):console[e]("%c"+s+this.SPACE_CHAR.repeat(Math.max(this.TYPE_SPACER_LENGTH-s.length,o?1:0))+"|",t,...i)}this.currentType=""}log(...t){this.message("log",...t)}info(...t){this.message("info",...t)}error(...t){this.message("error",...t)}warn(...t){this.message("warn",...t)}assert(...t){console.assert(...t)}debug(...t){this.message("debug",...t)}count(t){console.count(t)}countReset(t){console.countReset(t)}table(t,e){console.table(t,e)}time(t){this.message("time",t)}timeLog(t){this.message("timeLog",t)}timeEnd(t){this.message("timeEnd",t)}trace(...t){this.message("trace",...t)}group(t){this.message("group",t)}groupCollapsed(t){console.groupCollapsed(t)}groupEnd(){console.groupEnd()}clear(){console.clear()}registerType(t,e){this.types[t]||"string"==typeof t&&"string"==typeof e&&(this.types[t.toLowerCase()]=e)}registerTypes(e){if(Array.isArray(e))for(let t=0;t<e.length;t++)this.registerType(e[t].type,e[t].ansi)}unregisterType(t){this.types[t]&&delete this.types[t]}}var a=n.Y;const h=new class{transitions={};storedIDs=[];version="1.0.0";constructor(){this.logger=new a,this.logger.registerType("Utils-Module","#ff6600")}decimalRand(t,e,i=1){return 1<=(t=Number((Math.random()*(t-e)+e).toFixed(i)))?Math.floor(t):t}rand(t,e){return t=Number(Math.random()*(t-e)+e),Math.round(t)}getPercentage(t,e){return 100*t/e}clamp(t,e=0,i=1){return Math.max(e,Math.min(t,i))}lerp(t,e,i){return(1-i)*t+i*e}flooredLerp(t,e,i){return Math.floor(this.lerp(t,e,i))}round(t,e=1){return Math.round(e*t)/e}normalize(t,e,i){return i-e==0?1:(t-e)/(i-e)}normalizeRanged(t,e,i){return i-e==0?1:(t=-(2*this.normalize(t,e,i)-1),this.clamp(t,-1,1))}within(t,e,i){return e<=t&&t<=i}formatIntegerWithCommas(t){return t.toFixed().toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")}toRadians(t){return t*(Math.PI/180)}toDegrees(t){return t*(180/Math.PI)}pick(t){return t[Math.floor(Math.random()*t.length)]}removeProperties(t,e){if("object"==typeof t)for(const i in t)Array.isArray(e)&&e.includes(i)||t.hasOwnProperty(i)&&delete t[i]}prob(t){return!(t<=0)&&(100<=t||Math.floor(100*Math.random())+1<=t)}getInverseDirection(t){switch(t){case"north":return"south";case"south":return"north";case"east":return"west";case"west":return"east";case"northeast":return"southwest";case"northwest":return"southeast";case"southeast":return"northwest";case"southwest":return"northeast";default:this.logger.prefix("Utils-Module").error(`The direction ${t} is not supported.`)}}getAngleFromDirection(t){switch(t){case"north":return Math.PI/2;case"south":return 3*Math.PI/2;case"east":return 0;case"west":return Math.PI;case"northwest":return 3*Math.PI/4;case"northeast":return Math.PI/4;case"southwest":return 5*Math.PI/4;case"southeast":return 7*Math.PI/4;default:this.logger.prefix("Utils-Module").error(`The direction ${t} is not supported.`)}}centerRectangleOnParent(t,e,i,s,o,n){return{x:o+(i-t)/2,y:n+(s-e)/2}}getRandomAngle(){return Math.random()*(2*Math.PI)}getAngle(t,e){var i=t.y-e.y;return t=t.x-e.x,Math.atan2(i,t)}getAngle2(t,e){var i=t.y-e.y;return t=t.x-e.x,-1*(Math.atan2(i,t)-Math.PI)}convertRaWAngleToVyloCoords(t){return-1*(t-Math.PI)}getDistance(t,e){var i=t.y-e.y;return t=t.x-e.x,Math.sqrt(t*t+i*i)}calculateNewPositionFromDistanceAndAngle(t,e,i){var s={x:0,y:0};return s.x=t.x-e*Math.cos(i),s.y=t.y-e*Math.sin(i),s}calculateProportionalLength(t,e,i){return t/e*i}getDirection(t){return["east","northeast","north","northwest","west","southwest","south","southeast"][Math.abs(Math.floor(t*(180/Math.PI)/45+.5))%8]}linearDecay(t,e,i,s=.5){return Math.max(t*(1-e/i*s),1)}generateID(i=7){function t(){let e="";for(let t=0;t<i;t++)e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(Math.floor(62*Math.random()));return e}let e=t();for(;this.storedIDs.includes(e);)e=t();return this.storedIDs.push(e),e}decimalToHex(t,e=6){return"#"+(t+Math.pow(16,e)).toString(16).slice(-e).toUpperCase()}addIntensity(t,e){var i=(t=this.grabColor(t).rgbArray)[0],s=t[1];t=t[2];let o=0,n=0,r=0;var a=0===i&&0===s&&0===t;return(i||a)&&(o=i+Math.floor(255*e/100)),(s||a)&&(n=s+Math.floor(255*e/100)),(t||a)&&(r=t+Math.floor(255*e/100)),this.grabColor(this.clamp(o,0,255),this.clamp(n,0,255),this.clamp(r,0,255)).hex}rgbToHex(t,e,i){return"#"+[this.clamp(t,0,255),this.clamp(e,0,255),this.clamp(i,0,255)].map(function(t){return t.toString(16).padStart(2,"0")}).join("")}hexToRgb(t){return t=(t=3===(t=t.replace("#","")).length?t.replace(new RegExp("(.)","g"),"$1$1"):t).match(new RegExp("..","g")),[this.clamp(parseInt(t[0],16),0,255),this.clamp(parseInt(t[1],16),0,255),this.clamp(parseInt(t[2],16),0,255)]}rgbToDecimal(t,e,i){return t<<16|e<<8|i}hexToDecimal(t){return t=t.replace("#",""),parseInt(t,16)}grabColor(t=this.getRandomColor(),e,i){let s,o;return"number"==typeof t&&"number"==typeof e&&"number"==typeof i?s=this.rgbToHex(t,e,i):("number"==typeof t&&(t=this.decimalToHex(t)),s=t,o=this.hexToRgb(s)),{hex:s.toLowerCase(),hexTagless:s.replace("#","").toLowerCase(),rgb:"rgb("+o[0]+","+o[1]+","+o[2]+")",rgbArray:o,rgbObject:{r:o[0],g:o[1],b:o[2]},rgbNormal:[Math.round(o[0]/255*100)/100,Math.round(o[1]/255*100)/100,Math.round(o[2]/255*100)/100],decimal:this.hexToDecimal(s)}}getRandomColor(){let e="#";for(let t=0;t<6;t++)e+="0123456789ABCDEF"[Math.floor(16*Math.random())];return e}getRandomColorBetween(t,e,i=.5){return this.flooredLerp(this.grabColor(t).decimal,this.grabColor(e).decimal,i)}transitionColor(h,t="#000",e="#fff",l=1e3,i,s){if(globalThis.window){const c="function"==typeof i?i:null,u="function"==typeof s?s:null;let n,r,a;h?(n=h.id||this.generateID(),r="GeneratedParticle"===h.type,a="object"==typeof h.color&&h.color.constructor===Object,this.transitions[n]&&this.cancelTransitionColor(n)):n=this.generateID(),this.transitions[n]={duration:l,timeTracker:r?h.info.lifetime:0};const p=this.grabColor(t).rgbArray,g=this.grabColor(e).rgbArray,d=this;return this.transitions[n].step=t=>{if(d.transitions[n]){if(r){if(!h.info)return void(d.transitions[n]&&this.cancelTransitionColor(n));if(h.info.owner&&h.info.owner.settings.paused)return}d.transitions[n].lastTime||(d.transitions[n].lastTime=t);var e=t-d.transitions[n].lastTime,i=(d.transitions[n].timeTracker+=e,e=Math.min(d.transitions[n].timeTracker/d.transitions[n].duration,1),parseInt(d.lerp(p[0],g[0],e),10)),s=parseInt(d.lerp(p[1],g[1],e),10),o=parseInt(d.lerp(p[2],g[2],e),10),i=d.grabColor(i,s,o);c&&c(i),h&&(a?(h.color.tint=i.decimal,h.color=h.color):h.color=i.hex),1<=e||d.transitions[n].timeTracker>=l?(d.transitions[n]&&this.cancelTransitionColor(n),u&&u(i)):(d.transitions[n].req=globalThis.requestAnimationFrame(d.transitions[n].step),d.transitions[n].lastTime=t)}},this.transitions[n].req=globalThis.requestAnimationFrame(this.transitions[n].step),n}}cancelTransitionColor(t){this.transitions[t]&&(globalThis.cancelAnimationFrame(this.transitions[t].req),delete this.transitions[t])}getPointRotated(t,e,i){var s=t.x+t.width*("object"==typeof t.anchor&&t.anchor.x?t.anchor.x:.5),o=(t=t.y+t.height*("object"==typeof t.anchor&&t.anchor.y?t.anchor.y:.5),i.x-s);return i=i.y-t,{x:o*Math.cos(e)-i*-Math.sin(e)+s,y:o*-Math.sin(e)+i*Math.cos(e)+t}}getPointsOfRotatedRect(t,e){return{tl:this.getPointRotated(t,e,{x:t.x,y:t.y}),tr:this.getPointRotated(t,e,{x:t.x+t.width,y:t.y}),bl:this.getPointRotated(t,e,{x:t.x,y:t.y+t.height}),br:this.getPointRotated(t,e,{x:t.x+t.width,y:t.y+t.height}),center:this.getPointRotated(t,e,{x:t.x+t.width/2,y:t.y+t.height/2})}}calculateIconOffset(t={width:32,height:32},e={x:.5,y:.5},i={x:1,y:1}){var s=t.width*i.x,i=t.height*i.y;return{x:e.x*(s-t.width),y:e.y*(i-t.height)}}};var l=s.c,c={d:(t,e)=>{for(var i in e)c.o(e,i)&&!c.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)},u={};c.d(u,{Y:()=>p});class p{constructor(t){this.RESET="[0m",this.BRIGHT="[1m",this.DIM="[2m",this.UNDERSCORE="[4m",this.BLINK="[5m",this.REVERSE="[7m",this.HIDDEN="[8m",this.FG_BLACK="[30m",this.FG_RED="[31m",this.FG_GREEN="[32m",this.FG_YELLOW="[33m",this.FG_BLUE="[34m",this.FG_MAGENTA="[35m",this.FG_CYAN="[36m",this.FG_WHITE="[37m",this.FG_GRAY="[90m",this.BG_BLACK="[40m",this.BG_RED="[41m",this.BG_GREEN="[42m",this.BG_YELLOW="[43m",this.BG_BLUE="[44m",this.BG_MAGENTA="[45m",this.BG_CYAN="[46m",this.BG_WHITE="[47m",this.BG_GRAY="[100m",this.TYPE_SPACER_LENGTH=13,this.types={default:this.FG_WHITE},this.currentType="",this.SPACE_CHAR=" ",this.FG_COLORS={};for(let t=0;t<=255;t++)this.FG_COLORS[t]="[38;5;"+t+"m";this.BG_COLORS={};for(let t=0;t<=255;t++)this.BG_COLORS[t]="[48;5;"+t+"m";Array.isArray(t)&&this.registerTypes(t)}prefix(t){return"string"==typeof t&&(this.currentType=t),this}message(e="log",...i){var s=this.currentType||"";if(0===s.length)console[e](...i);else{var o=s.length>=this.TYPE_SPACER_LENGTH;let t=this.types[s.toLowerCase()]?this.types[s.toLowerCase()]:this.types.default;var n=t.includes("");n||(t="color: "+t),!globalThis.window||n?console[e](t+s+this.SPACE_CHAR.repeat(Math.max(this.TYPE_SPACER_LENGTH-s.length,o?1:0))+"|"+this.RESET,...i):console[e]("%c"+s+this.SPACE_CHAR.repeat(Math.max(this.TYPE_SPACER_LENGTH-s.length,o?1:0))+"|",t,...i)}this.currentType=""}log(...t){this.message("log",...t)}info(...t){this.message("info",...t)}error(...t){this.message("error",...t)}warn(...t){this.message("warn",...t)}assert(...t){console.assert(...t)}debug(...t){this.message("debug",...t)}count(t){console.count(t)}countReset(t){console.countReset(t)}table(t,e){console.table(t,e)}time(t){this.message("time",t)}timeLog(t){this.message("timeLog",t)}timeEnd(t){this.message("timeEnd",t)}trace(...t){this.message("trace",...t)}group(t){this.message("group",t)}groupCollapsed(t){console.groupCollapsed(t)}groupEnd(){console.groupEnd()}clear(){console.clear()}registerType(t,e){this.types[t]||"string"==typeof t&&"string"==typeof e&&(this.types[t.toLowerCase()]=e)}registerTypes(e){if(Array.isArray(e))for(let t=0;t<e.length;t++)this.registerType(e[t].type,e[t].ansi)}unregisterType(t){this.types[t]&&delete this.types[t]}}var g=u.Y,d={d:(t,e)=>{for(var i in e)d.o(e,i)&&!d.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)},y={},m=(d.d(y,{G:()=>M}),{d:(t,e)=>{for(var i in e)m.o(e,i)&&!m.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)}),f={};m.d(f,{Y:()=>T});class T{constructor(t){this.RESET="[0m",this.BRIGHT="[1m",this.DIM="[2m",this.UNDERSCORE="[4m",this.BLINK="[5m",this.REVERSE="[7m",this.HIDDEN="[8m",this.FG_BLACK="[30m",this.FG_RED="[31m",this.FG_GREEN="[32m",this.FG_YELLOW="[33m",this.FG_BLUE="[34m",this.FG_MAGENTA="[35m",this.FG_CYAN="[36m",this.FG_WHITE="[37m",this.FG_GRAY="[90m",this.BG_BLACK="[40m",this.BG_RED="[41m",this.BG_GREEN="[42m",this.BG_YELLOW="[43m",this.BG_BLUE="[44m",this.BG_MAGENTA="[45m",this.BG_CYAN="[46m",this.BG_WHITE="[47m",this.BG_GRAY="[100m",this.TYPE_SPACER_LENGTH=13,this.types={default:this.FG_WHITE},this.currentType="",this.SPACE_CHAR=" ",this.FG_COLORS={};for(let t=0;t<=255;t++)this.FG_COLORS[t]="[38;5;"+t+"m";this.BG_COLORS={};for(let t=0;t<=255;t++)this.BG_COLORS[t]="[48;5;"+t+"m";Array.isArray(t)&&this.registerTypes(t)}prefix(t){return"string"==typeof t&&(this.currentType=t),this}message(e="log",...i){var s=this.currentType||"";if(0===s.length)console[e](...i);else{var o=s.length>=this.TYPE_SPACER_LENGTH;let t=this.types[s.toLowerCase()]?this.types[s.toLowerCase()]:this.types.default;var n=t.includes("");n||(t="color: "+t),!globalThis.window||n?console[e](t+s+this.SPACE_CHAR.repeat(Math.max(this.TYPE_SPACER_LENGTH-s.length,o?1:0))+"|"+this.RESET,...i):console[e]("%c"+s+this.SPACE_CHAR.repeat(Math.max(this.TYPE_SPACER_LENGTH-s.length,o?1:0))+"|",t,...i)}this.currentType=""}log(...t){this.message("log",...t)}info(...t){this.message("info",...t)}error(...t){this.message("error",...t)}warn(...t){this.message("warn",...t)}assert(...t){console.assert(...t)}debug(...t){this.message("debug",...t)}count(t){console.count(t)}countReset(t){console.countReset(t)}table(t,e){console.table(t,e)}time(t){this.message("time",t)}timeLog(t){this.message("timeLog",t)}timeEnd(t){this.message("timeEnd",t)}trace(...t){this.message("trace",...t)}group(t){this.message("group",t)}groupCollapsed(t){console.groupCollapsed(t)}groupEnd(){console.groupEnd()}clear(){console.clear()}registerType(t,e){this.types[t]||"string"==typeof t&&"string"==typeof e&&(this.types[t.toLowerCase()]=e)}registerTypes(e){if(Array.isArray(e))for(let t=0;t<e.length;t++)this.registerType(e[t].type,e[t].ansi)}unregisterType(t){this.types[t]&&delete this.types[t]}}var b=f.Y;class E{static tracker={ids:[]};static storedIDs=[];instanceWeakMap=new WeakMap;version="1.0.0";constructor(){this.logger=new b,this.logger.registerType("PulseComponent-Module","#ff6600")}generateID(i=7){function t(){let e="";for(let t=0;t<i;t++)e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(Math.floor(62*Math.random()));return e}let e=t();for(;E.storedIDs.includes(e);)e=t();return E.storedIDs.push(e),e}on(e,i,s){if("function"!=typeof s)this.logger.prefix("PulseComponent-Module").error("pFunction argument is missing or it is not of the function type!");else{let t=this.instanceWeakMap.get(e);t||(t=this.generateID(),this.instanceWeakMap.set(e,t),E.tracker.ids.push(t),E.tracker[t]={},E.tracker[t].listened={}),E.tracker[t][i]||(E.tracker[t][i]={counter:0});var o=++E.tracker[t][i].counter;E.tracker[t].listened[i]||this.listenForEvent(e,i),E.tracker[t][i][o]=s,"onNew"===i&&E.tracker[t][i][o].bind(e)()}}off(t,e,i){if("function"!=typeof i)this.logger.prefix("PulseComponent-Module").error("pFunction argument is missing or it is not of the function type!");else{var s=this.instanceWeakMap.get(t);if(s){for(const t in E.tracker[s][e])if(E.tracker[s][e][t]===i)return void delete E.tracker[s][e][t];this.logger.prefix("PulseComponent-Module").error("This function is not being tracked.")}}}listenForEvent(t,e){let i=t[e];const s=this.instanceWeakMap.get(t);t[e]=function(){"function"==typeof i&&i.apply(t,arguments);for(const i in E.tracker[s][e])"function"==typeof E.tracker[s][e][i]&&E.tracker[s][e][i].apply(t,arguments)},E.tracker[s].listened[e]=!0}}const M=new E;var C=y.G,v={d:(t,e)=>{for(var i in e)v.o(e,i)&&!v.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)},w={},O=(v.d(w,{k:()=>A}),{d:(t,e)=>{for(var i in e)O.o(e,i)&&!O.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)}),j={};O.d(j,{Y:()=>k});class k{constructor(t){this.RESET="[0m",this.BRIGHT="[1m",this.DIM="[2m",this.UNDERSCORE="[4m",this.BLINK="[5m",this.REVERSE="[7m",this.HIDDEN="[8m",this.FG_BLACK="[30m",this.FG_RED="[31m",this.FG_GREEN="[32m",this.FG_YELLOW="[33m",this.FG_BLUE="[34m",this.FG_MAGENTA="[35m",this.FG_CYAN="[36m",this.FG_WHITE="[37m",this.FG_GRAY="[90m",this.BG_BLACK="[40m",this.BG_RED="[41m",this.BG_GREEN="[42m",this.BG_YELLOW="[43m",this.BG_BLUE="[44m",this.BG_MAGENTA="[45m",this.BG_CYAN="[46m",this.BG_WHITE="[47m",this.BG_GRAY="[100m",this.TYPE_SPACER_LENGTH=13,this.types={default:this.FG_WHITE},this.currentType="",this.SPACE_CHAR=" ",this.FG_COLORS={};for(let t=0;t<=255;t++)this.FG_COLORS[t]="[38;5;"+t+"m";this.BG_COLORS={};for(let t=0;t<=255;t++)this.BG_COLORS[t]="[48;5;"+t+"m";Array.isArray(t)&&this.registerTypes(t)}prefix(t){return"string"==typeof t&&(this.currentType=t),this}message(e="log",...i){var s=this.currentType||"";if(0===s.length)console[e](...i);else{var o=s.length>=this.TYPE_SPACER_LENGTH;let t=this.types[s.toLowerCase()]?this.types[s.toLowerCase()]:this.types.default;var n=t.includes("");n||(t="color: "+t),!globalThis.window||n?console[e](t+s+this.SPACE_CHAR.repeat(Math.max(this.TYPE_SPACER_LENGTH-s.length,o?1:0))+"|"+this.RESET,...i):console[e]("%c"+s+this.SPACE_CHAR.repeat(Math.max(this.TYPE_SPACER_LENGTH-s.length,o?1:0))+"|",t,...i)}this.currentType=""}log(...t){this.message("log",...t)}info(...t){this.message("info",...t)}error(...t){this.message("error",...t)}warn(...t){this.message("warn",...t)}assert(...t){console.assert(...t)}debug(...t){this.message("debug",...t)}count(t){console.count(t)}countReset(t){console.countReset(t)}table(t,e){console.table(t,e)}time(t){this.message("time",t)}timeLog(t){this.message("timeLog",t)}timeEnd(t){this.message("timeEnd",t)}trace(...t){this.message("trace",...t)}group(t){this.message("group",t)}groupCollapsed(t){console.groupCollapsed(t)}groupEnd(){console.groupEnd()}clear(){console.clear()}registerType(t,e){this.types[t]||"string"==typeof t&&"string"==typeof e&&(this.types[t.toLowerCase()]=e)}registerTypes(e){if(Array.isArray(e))for(let t=0;t<e.length;t++)this.registerType(e[t].type,e[t].ansi)}unregisterType(t){this.types[t]&&delete this.types[t]}}var P=j.Y;class A{constructor({start:t={},end:e={},duration:i=1e3,easing:s=A.linear}={}){this._build(t,e,i,s)}static linear(t,e,i,s){return i*t/s+e}static easeInQuad(t,e,i,s){return i*(t/=s)*t+e}static easeOutQuad(t,e,i,s){return-i*(t/=s)*(t-2)+e}static easeInOutQuad(t,e,i,s){return(t/=s/2)<1?i/2*t*t+e:-i/2*(--t*(t-2)-1)+e}static easeInSine(t,e,i,s){return-i*Math.cos(t/s*(Math.PI/2))+i+e}static easeOutSine(t,e,i,s){return i*Math.sin(t/s*(Math.PI/2))+e}static easeInOutSine(t,e,i,s){return-i/2*(Math.cos(Math.PI*t/s)-1)+e}static easeInExpo(t,e,i,s){return 0==t?e:i*Math.pow(2,10*(t/s-1))+e}static easeOutExpo(t,e,i,s){return t==s?e+i:i*(1-Math.pow(2,-10*t/s))+e}static easeInOutExpo(t,e,i,s){return 0==t?e:t==s?e+i:(t/=s/2)<1?i/2*Math.pow(2,10*(t-1))+e:i/2*(2-Math.pow(2,-10*--t))+e}static easeInCirc(t,e,i,s){return-i*(Math.sqrt(1-(t/=s)*t)-1)+e}static easeOutCirc(t,e,i,s){return i*Math.sqrt(1-(t=t/s-1)*t)+e}static easeInOutCirc(t,e,i,s){return(t/=s/2)<1?-i/2*(Math.sqrt(1-t*t)-1)+e:i/2*(Math.sqrt(1-(t-=2)*t)+1)+e}static easeInCubic(t,e,i,s){return i*(t/=s)*t*t+e}static easeOutCubic(t,e,i,s){return i*((t=t/s-1)*t*t+1)+e}static easeInOutCubic(t,e,i,s){return(t/=s/2)<1?i/2*t*t*t+e:i/2*((t-=2)*t*t+2)+e}static easeInQuart(t,e,i,s){return i*(t/=s)*t*t*t+e}static easeOutQuart(t,e,i,s){return-i*((t=t/s-1)*t*t*t-1)+e}static easeInOutQuart(t,e,i,s){return(t/=s/2)<1?i/2*t*t*t*t+e:-i/2*((t-=2)*t*t*t-2)+e}static easeInQuint(t,e,i,s){return i*(t/=s)*t*t*t*t+e}static easeOutQuint(t,e,i,s){return i*((t=t/s-1)*t*t*t*t+1)+e}static easeInOutQuint(t,e,i,s){return(t/=s/2)<1?i/2*t*t*t*t*t+e:i/2*((t-=2)*t*t*t*t+2)+e}static easeInElastic(t,e,i,s){var o,n=i;return 0==t?e:1==(t/=s)?e+i:(o=.3*s,i=n<Math.abs(i)?(n=i,o/4):0===i&&0===n?o/(2*Math.PI)*Math.asin(1):o/(2*Math.PI)*Math.asin(i/n),-n*Math.pow(2,10*--t)*Math.sin((t*s-i)*(2*Math.PI)/o)+e)}static easeOutElastic(t,e,i,s){var o,n,r=i;return 0==t?e:1==(t/=s)?e+i:(n=.3*s,o=r<Math.abs(i)?(r=i,n/4):0===i&&0===r?n/(2*Math.PI)*Math.asin(1):n/(2*Math.PI)*Math.asin(i/r),r*Math.pow(2,-10*t)*Math.sin((t*s-o)*(2*Math.PI)/n)+i+e)}static easeInOutElastic(t,e,i,s){var o,n,r=i;return 0==t?e:2==(t/=s/2)?e+i:(n=s*(.3*1.5),o=r<Math.abs(i)?(r=i,n/4):0===i&&0===r?n/(2*Math.PI)*Math.asin(1):n/(2*Math.PI)*Math.asin(i/r),t<1?r*Math.pow(2,10*--t)*Math.sin((t*s-o)*(2*Math.PI)/n)*-.5+e:r*Math.pow(2,-10*--t)*Math.sin((t*s-o)*(2*Math.PI)/n)*.5+i+e)}static easeInBack(t,e,i,s){return i*(t/=s)*t*(2.70158*t-1.70158)+e}static easeOutBack(t,e,i,s){return i*((t=t/s-1)*t*(2.70158*t+1.70158)+1)+e}static easeInOutBack(t,e,i,s){var o=1.70158;return(t/=s/2)<1?i/2*(t*t*((1+(o*=1.525))*t-o))+e:i/2*((t-=2)*t*((1+(o*=1.525))*t+o)+2)+e}static easeInBounce(t,e,i,s){return i-this.easeOutBounce(s-t,0,i,s)+e}static easeOutBounce(t,e,i,s){return(t/=s)<1/2.75?7.5625*i*t*t+e:t<2/2.75?i*(7.5625*(t-=1.5/2.75)*t+.75)+e:t<2.5/2.75?i*(7.5625*(t-=2.25/2.75)*t+.9375)+e:i*(7.5625*(t-=2.625/2.75)*t+.984375)+e}static easeInOutBounce(t,e,i,s){return t<.5*s?.5*this.easeInBounce(2*t,0,i,s)+e:.5*this.easeOutBounce(2*t-s,0,i,s)+.5*i+e}static _clamp(t,e=0,i=1){return Math.max(e,Math.min(t,i))}static _hexToRgb(t){return t=(t=3===(t=t.replace("#","")).length?t.replace(new RegExp("(.)","g"),"$1$1"):t).match(new RegExp("..","g")),[A._clamp(parseInt(t[0],16),0,255),A._clamp(parseInt(t[1],16),0,255),A._clamp(parseInt(t[2],16),0,255)]}static _rgbToHex(t){if(Array.isArray(t))return"#"+t.map(t=>Math.abs(Math.round(t)).toString(16).padStart(2,"0")).join("")}version="1.0.0";_build(t,e,i,s){this.start=t,this.end=e,this.duration=i,this.easing="function"==typeof s?s:A.linear,this.events={},this.exportedValues={},this.tweening=!1,this.update=null,this.paused=!1,this.lastTime=0,this.elapsed=0}build({start:t={},end:e={},duration:i=1e3,easing:s=A.linear}={}){return this._build(t,e,i,s),this}on(t,e){if("function"==typeof e)switch(t){case"start":case"end":case"pause":case"resume":this.events[t]=e;break;default:I.prefix("Tween-Module").error(`The event "${t}" is not supported.`)}else I.prefix("Tween-Module").error(`The callback for event "${t}" is not a function.`);return this}animationFrame=()=>{if(this.tweening&&!this.paused){var s,o,t=Date.now();this.lastTime||(this.lastTime=t),this.elapsed+=t-this.lastTime;let i=this.elapsed/this.duration;for(s in 1<(i=this.oscillating?(1-Math.cos(i*Math.PI))/2:i)&&(i=1),this.end){let t=this.start[s],e=this.end[s];"string"==typeof t&&(3===t.length||6===t.length)||4===t.length||7===t.length?(t=A._hexToRgb(t),e=A._hexToRgb(e),o=[this.easing(i,t[0],e[0]-t[0],1),this.easing(i,t[1],e[1]-t[1],1),this.easing(i,t[2],e[2]-t[2],1)],this.exportedValues[s]=A._rgbToHex(o)):this.exportedValues[s]=this.easing(i,t,e-t,1)}this.update(this.exportedValues),1!==i||this.oscillating?requestAnimationFrame(this.animationFrame):(this.stop(),this.events.end&&this.events.end()),this.lastTime=t}};animate(i,s=!1){if("function"!=typeof i)I.prefix("Tween-Module").error("The pUpdate parameter passed to animate is not a function.");else if(!this.tweening){let t=Object.keys(this.start),e=Object.keys(this.end);if(t.length&&e.length){if(t.every(t=>e.includes(t)))return this.update=i,this.tweening=!0,this.elapsed=0,this.oscillating=s,this.events.start&&this.events.start(),requestAnimationFrame(this.animationFrame),this;I.prefix("Tween-Module").error("The end object is missing properties that the start object has.")}else I.prefix("Tween-Module").error("The start object or the end object has no properties.")}}resume(){return this.paused&&(this.lastTime=Date.now(),this.paused=!1,this.events.resume&&this.events.resume(),requestAnimationFrame(this.animationFrame)),this}pause(){return this.paused||(this.paused=!0,this.events.pause&&this.events.pause()),this}stop(){this.tweening=!1,this.oscillating=!1,this.update=null,this.elapsed=0,this.lastTime=0,this.paused=!1;for(const t in this.exportedValues)this.exportedValues.hasOwnProperty(t)&&delete this.exportedValues[t]}}const I=new P;I.registerType("Tween-Module","#ff6600");var x=w.k;class _{static MAX_LAYER=1999998;tween=new x;joyring=null;joystick=null;version="1.0.0";options=null;lockedDimension=null;zone=null;activeInZone=!1;controllingFinger=null;active=!1;onRelease=null;onMove=null;constructor(t){this.build(t)}setup(){this.joyring.atlasName=this.options.atlasName,this.joyring.iconName=this.options.joyringIconName,this.joyring.touchOpacity=L.constructor.MULTI_TOUCH,this.joyring.interfaceType="default",this.joyring.color={tint:16777215},this.joyring.scale=1,this.joyring.anchor={x:.5,y:.5},this.joyring.plane=this.options.plane,this.joyring.layer=this.options.layer,this.joyring.width=this.options.size,this.joyring.height=this.options.size,this.joyring.halfSize=this.joyring.width/2,this.joyring.child=this.joystick,this.joyring.isMobileHandlerController=!0,this.joyring.originalPos={x:this.options.position.x,y:this.options.position.y},this.joystick.atlasName=this.options.atlasName,this.joystick.iconName=this.options.joystickIconName,this.joystick.touchOpacity=L.constructor.NO_TOUCH,this.joystick.interfaceType="default",this.joystick.color={tint:16777215},this.joystick.scale=1,this.joystick.anchor={x:.5,y:.5},this.joystick.startPos={x:0,y:0},this.joystick.width=this.options.size/2,this.joystick.height=this.options.size/2,this.joystick.plane=this.options.plane,this.joystick.layer=this.options.layer+1,this.joystick.anglePoint=0,this.joystick.halfSize=this.joystick.width/2,this.joystick.parent=this.joyring,this.joystick.originalPos={x:this.joyring.originalPos.x+this.joystick.halfSize,y:this.joyring.originalPos.y+this.joystick.halfSize},((this.joyring.controller=this).joystick.controller=this).joyring.onTouchBegin=this.options.callback.onTouchBegin,this.onRelease=this.options.callback.onRelease,this.onMove=this.options.callback.onMove,this.lockedDimension=this.options.lockedDimension,this.lock(this.lockedDimension),VYLO.Client.addInterfaceElement(this.joyring,"mobile-handler-interface",this.joyring.id),VYLO.Client.addInterfaceElement(this.joystick,"mobile-handler-interface",this.joystick.id),L.activeControllers.push(this),this.show()}handleTransition(t){var e={alpha:this.joyring.alpha},i=this.options.transitionTime,s=x.easeInOutQuad;!this.options.inactiveAlpha&&0!==this.options.inactiveAlpha||(this.tween.stop(),t=t?{alpha:this.options.inactiveAlpha}:{alpha:1},e.alpha===t.alpha)||this.tween.build({start:e,end:t,duration:i,easing:s}).animate(({alpha:t})=>{this.joyring.alpha=t,this.joystick.alpha=t})}reset(t){var e=this.joystick.anglePoint;this.joystick.alpha=this.options.inactiveAlpha,this.joystick.startPos.x=this.joystick.startPos.y=0,this.joystick.anglePoint=0,this.joyring.layer=this.options.layer,this.joystick.layer=this.options.layer+10,this.activeInZone=!1,this.controllingFinger=null,this.active&&(this.active=!1,"function"==typeof this.onRelease)&&this.onRelease(VYLO.Client,e),t||(this.onRelease=null,this.onMove=null,this.joyring.onTouchBegin=null,this.zone&&(L.reservedScreenZones.includes(this.zone)&&L.reservedScreenZones.splice(L.reservedScreenZones.indexOf(this.zone),1),"left"!==this.zone&&"right"!==this.zone||(L.zonedControllers[this.zone]=null)),this.zone=null,this.lockedDimension=null,this.options={},L.touchedInstances.includes(this.joyring)&&L.touchedInstances.splice(L.touchedInstances.indexOf(this.joyring),1))}build(t={type:"stationary",size:100,position:{x:100,y:100},lockedDimension:null,zone:null,inactiveAlpha:.5,transitionTime:500,scale:1,plane:1,layer:1,atlasName:"",joystickIconName:"",joyringIconName:"",callback:{onTouchBegin:null,onRelease:null,onMove:null}}){if(!this.joyring&&!this.joystick){const t=VYLO.newDiob("Interface"),e=VYLO.newDiob("Interface");this.joyring=t,this.joystick=e}if(Number.isInteger(t.size)||(t.size=100,L.logger.prefix("MobileHandler-Module").warn("pOptions.size was not an integer. Default value of 100 has been used.")),"string"==typeof t.type?"traversal"!==t.type&&"static"!==t.type&&"stationary"!==t.type&&(t.type="stationary"):(t.type="stationary",L.logger.prefix("MobileHandler-Module").warn("pOptions.type was not a string. Default value of stationary has been used.")),"traversal"===t.type||"static"===t.type){if(L.reservedScreenZones.length&&(!t.zone||"string"!=typeof t.zone||L.reservedScreenZones.includes(t.zone)))return void L.logger.prefix("MobileHandler-Module").error("When using a controller that is of the traversal type, or the static type. A zone is REQUIRED. Only two controllers of traversal or static or one of each can be used at a time. These controllers have to have opposing zones. Left | Right");"left"!==t.zone&&"right"!==t.zone||(L.reservedScreenZones.push(t.zone),(L.zonedControllers[t.zone]=this).zone=t.zone)}"string"!=typeof t.atlasName&&(t.atlasName="",L.logger.prefix("MobileHandler-Module").warn("pOptions.atlasName was not a string. No value has been used.")),t.lockedDimension&&("traversal"===t.type?L.logger.prefix("MobileHandler-Module").warn("pOptions.type is traversal. A traversal controller cannot be locked."):("string"!=typeof t.lockedDimension||"both"!==t.lockedDimension&&"vertical"!==t.lockedDimension&&"horizontal"!==t.lockedDimension)&&(t.lockedDimension=null,L.logger.prefix("MobileHandler-Module").warn("Invalid value for pOptions.lockedDimension has been passed. No value has been set."))),"string"!=typeof t.joystickIconName&&(t.joystickIconName="",L.logger.prefix("MobileHandler-Module").warn("pOptions.joystickIconName was not a string. No value has been used.")),"string"!=typeof t.joyringIconName&&(t.joyringIconName="",L.logger.prefix("MobileHandler-Module").warn("pOptions.joyringIconName was not a string. No value has been used.")),"number"!=typeof t.transitionTime&&(t.transitionTime=500),"number"!=typeof t.inactiveAlpha&&(t.inactiveAlpha=.5),Number.isInteger(t.scale)||(t.scale=1,L.logger.prefix("MobileHandler-Module").warn("A non integer value was found in option for scale. Default scale of 1 has been used.")),"number"!=typeof t.plane&&(t.plane=1),"number"!=typeof t.layer&&(t.layer=1),t.position.constructor===Object?(Number.isInteger(t.position.x)||(t.position.x=100,L.logger.prefix("MobileHandler-Module").warn("position.x variable found in options was not a number. Default position.x value has been used.")),Number.isInteger(t.position.y)||(t.position.y=100,L.logger.prefix("MobileHandler-Module").warn("position.y variable found in options was not a number. Default position.y value has been used."))):(t.position={x:100,y:100},L.logger.prefix("MobileHandler-Module").warn("position variable found in options was not an object. Default position has been used.")),this.options=t,this.setup()}getType(){return this.options.type}update(n,r,a){if("both"!==this.lockedDimension&&(a&&(this.handleTransition(),this.joyring.layer=_.MAX_LAYER,this.joystick.layer=_.MAX_LAYER+10,this.active=!0),this.active)){var h={x:n-this.joystick.halfSize,y:r-this.joystick.halfSize};let t,e,i,s,o;if("stationary"===this.options.type)t=this.joystick.originalPos,"horizontal"===this.lockedDimension?h.y=t.y:"vertical"===this.lockedDimension&&(h.x=t.x),e=l.getDistance(t,h),i=l.getAngle(t,h),s=Math.min(e,this.joyring.halfSize),o=l.calculateNewPositionFromDistanceAndAngle(t,s,i),this.joystick.setPos(o.x,o.y);else if("traversal"===this.options.type||"static"===this.options.type){if(a)return this.joystick.startPos=h,this.joyring.setPos(h.x-this.joystick.halfSize,h.y-this.joystick.halfSize),void this.joystick.setPos(h.x,h.y);if("traversal"===this.options.type){e=l.getDistance(this.joystick.startPos,h),i=l.getAngle(this.joystick.startPos,h),s=Math.min(e,this.joyring.halfSize),o=l.calculateNewPositionFromDistanceAndAngle(this.joystick.startPos,s,i),this.joystick.setPos(h.x,h.y);const n=l.getAngle(h,this.joystick.startPos),r=l.calculateNewPositionFromDistanceAndAngle(h,s,n);this.joyring.setPos(r.x-this.joystick.halfSize,r.y-this.joystick.halfSize),e>s&&(this.joystick.startPos.x=this.joyring.xPos+this.joystick.halfSize,this.joystick.startPos.y=this.joyring.yPos+this.joystick.halfSize)}else"static"===this.options.type&&("horizontal"===this.lockedDimension?h.y=this.joystick.startPos.y:"vertical"===this.lockedDimension&&(h.x=this.joystick.startPos.x),e=l.getDistance(this.joystick.startPos,h),i=l.getAngle(this.joystick.startPos,h),s=Math.min(e,this.joyring.halfSize),o=l.calculateNewPositionFromDistanceAndAngle(this.joystick.startPos,s,i),this.joystick.setPos(o.x,o.y))}this.joystick.anglePoint=l.convertRaWAngleToVyloCoords(i);n=.1*this.joyring.width,r=Math.abs(s)<n,a="stationary"===this.options.type?t:this.joystick.startPos,n=l.normalizeRanged(a.x,h.x-this.joyring.halfSize,h.x+this.joyring.halfSize),a=l.normalizeRanged(a.y,h.y-this.joyring.halfSize,h.y+this.joyring.halfSize);"function"==typeof this.onMove&&this.onMove(VYLO.Client,n,a,this.joystick.anglePoint,r)}}release(t){"both"!==this.lockedDimension&&(t||this.reset(!0),this.joyring.setPos(this.joyring.originalPos.x,this.joyring.originalPos.y),this.joystick.setPos(this.joystick.originalPos.x,this.joystick.originalPos.y),this.handleTransition(!0))}lock(t){"string"==typeof(t=t&&t.toLowerCase())&&(this.lockedDimension="horizontal"===t?"horizontal":"vertical"===t?"vertical":"both")}unlock(t){"string"==typeof(t=t&&t.toLowerCase())&&("horizontal"===t?"both"===this.lockedDimension?this.lockedDimension="vertical":this.lockedDimension=null:"vertical"===t&&"both"===this.lockedDimension?this.lockedDimension="horizontal":this.lockedDimension=null)}getComponents(){return{joystick:this.joystick,joyring:this.joyring}}hide(){this.joyring.hide(),this.joystick.hide(),this.reset(!0)}show(){this.joyring.setPos(this.joyring.originalPos.x,this.joyring.originalPos.y),this.joystick.setPos(this.joystick.originalPos.x,this.joystick.originalPos.y),this.joyring.show(),this.joystick.show(),this.handleTransition(!0)}}class R{static MULTI_TOUCH=2;static NO_TOUCH=0;static MAX_RECYCLED_CONTROLLERS=10;static MAX_LAYER=1999998;recycledControllers=[];activeControllers=[];zonedControllers={};touchedInstances=[];mapPositionObject={x:0,y:0};reservedScreenZones=[];windowSize=VYLO.World.getGameSize();xCenterScreenPosition=this.windowSize.width/2;instanceWeakMap=new WeakMap;version="1.0.0";constructor(){this.logger=new g,this.logger.registerType("MobileHandler-Module","#ff6600"),VYLO.Client.createInterface("mobile-handler-interface"),VYLO.Client.showInterface("mobile-handler-interface"),this.queryUserAgent(),this.registerEventHandlers(),this.querySafeAreaValues()}getSafeAreaInsets(){return{...this.safeAreaValues}}getSafeAreaTop(){return this.safeAreaValues.top}getSafeAreaBottom(){return this.safeAreaValues.bottom}getSafeAreaLeft(){return this.safeAreaValues.left}getSafeAreaRight(){return this.safeAreaValues.right}detectDeviceType(){return/iphone|ipad|ipod|android|blackberry|mini|windows\sce|palm/i.test(navigator.userAgent.toLowerCase())?"mobile":"desktop"}vibrate(t=500){"undefined"!=typeof navigator&&navigator.vibrate&&navigator.vibrate(t)}isTouchDevice(){return this.isTouchEnabled}isMobileDevice(){return this.isMobile}isIOSDevice(){return this.isIOS}isAndroidDevice(){return this.isAndroid}getDeviceRAM(){if("undefined"!=typeof navigator)return navigator.deviceMemory}createController(t){var e;return this.recycledControllers.length?((e=this.recycledControllers.pop()).build(t),e):new _(t)}windowResizeHandler(t,e){this.xCenterScreenPosition=t/2,this.windowSize.width=t,this.windowSize.height=e;for(const t of this.activeControllers){const e=t.getComponents();e.joyring.edgeLock&&(e.joyring.originalPos={x:e.joyring.x,y:e.joyring.y}),e.joystick.edgeLock&&(e.joystick.originalPos={x:e.joystick.x,y:e.joystick.y})}}getDiobUnderFinger(t,i){var s=VYLO.Client.getScreenScale(),s=VYLO.Client.getPosFromScreen(t/s.x,i/s.y);if(VYLO.Client.mob){var o=VYLO.Client.mob.mapName?VYLO.Map.getDiobsByPos(VYLO.Client.mob.mapName,s.x,s.y):[],n=VYLO.Client.getInterfaceElementsFromScreen(t,i,null,null,null,null,!0);let e;for(let t=0;t<n.length;t++)(n[t].touchOpacity||void 0===n[t].touchOpacity)&&(e=e||n[t],n[t].layer>=e.layer)&&(e=n[t]);if(e)return!VYLO.Client.checkInterfaceShown(e.getInterfaceName())||e.isHidden?null:e;if(VYLO.Client.mob.mapName)for(let t=0;t<o.length;t++)if(o[t].touchOpacity)return o[t];return null}}registerEventHandlers(){C.on(VYLO.Client,"onWindowResize",this.windowResizeHandler.bind(this)),document.getElementById("game_body"),window.addEventListener("touchstart",this.handleStart.bind(this),{passive:!1}),window.addEventListener("touchend",this.handleEnd.bind(this),{passive:!1}),window.addEventListener("touchcancel",this.handleCancel.bind(this),{passive:!1}),window.addEventListener("touchmove",this.handleMove.bind(this),{passive:!1}),window.addEventListener("gesturestart",function(t){t.preventDefault()},{passive:!1}),window.addEventListener("gesturechange",function(t){t.preventDefault()},{passive:!1})}querySafeAreaValues(){var t=document.createElement("style"),t=(t.textContent="\n\t\t\t:root {\n\t\t\t--safe-area-inset-top: env(safe-area-inset-top);\n\t\t\t--safe-area-inset-right: env(safe-area-inset-right);\n\t\t\t--safe-area-inset-bottom: env(safe-area-inset-bottom);\n\t\t\t--safe-area-inset-left: env(safe-area-inset-left);\n\t\t\t}\n\t\t",document.head.appendChild(t),getComputedStyle(document.documentElement)),e=parseInt(t.getPropertyValue("--safe-area-inset-top").replace("px","")),i=parseInt(t.getPropertyValue("--safe-area-inset-right").replace("px","")),s=parseInt(t.getPropertyValue("--safe-area-inset-bottom").replace("px","")),t=parseInt(t.getPropertyValue("--safe-area-inset-left").replace("px",""));this.safeAreaValues={top:e,right:i,bottom:s,left:t}}queryUserAgent(){this.isIOS=/iPad|iPhone|iPod/.test(navigator.userAgent),this.isAndroid=/Android/.test(navigator.userAgent),this.isTouchEnabled="ontouchstart"in document.documentElement,this.isMobile="mobile"===this.detectDeviceType()}track(t){this.instanceWeakMap.set(t,{trackedTouches:[],slidOff:!1}),this.touchedInstances.push(t)}isTracking(t){return this.instanceWeakMap.get(t)&&this.touchedInstances.includes(t)}getTrackerObject(t){return this.instanceWeakMap.get(t)}handleZoneTouch(t,e,i){if(this.reservedScreenZones.length){var s=this.zonedControllers.right,o=this.zonedControllers.left;t>this.xCenterScreenPosition&&s?s.activeInZone&&"traversal"!==s.getType()||(s.controllingFinger=i,s.activeInZone=!0,s.update(t,e,!0)):t<this.xCenterScreenPosition&&o&&(o.activeInZone&&"traversal"!==o.getType()||(o.controllingFinger=i,o.activeInZone=!0,o.update(t,e,!0)))}else for(const r of this.activeControllers){var n=r.getType();if(!(r.activeInZone&&"traversal"!==n||"traversal"!==n&&"static"!==n))return r.controllingFinger=i,r.activeInZone=!0,void r.update(t,e,!0)}}handleZoneRelease(t){if(this.reservedScreenZones.length){var e=this.zonedControllers.right,i=this.zonedControllers.left;e&&e.controllingFinger===t&&e.activeInZone?e.release():i&&i.controllingFinger===t&&i.activeInZone&&i.release()}else for(const o of this.activeControllers){var s=o.getType();if(("traversal"===s||"static"===s)&&o.activeInZone&&o.controllingFinger===t)return void o.release()}}handleZoneMove(t,e,i){if(this.reservedScreenZones.length){var s=this.zonedControllers.right,o=this.zonedControllers.left;s&&s.controllingFinger===i&&s.activeInZone?s.update(t,e):o&&o.controllingFinger===i&&o.activeInZone&&o.update(t,e)}else for(const r of this.activeControllers){var n=r.getType();"traversal"!==n&&"static"!==n||!r.activeInZone||r.controllingFinger===i&&r.update(t,e)}}handleStart(e){const i=e.changedTouches,s=document.getElementById("game_body").getBoundingClientRect(),o=s.x,n=s.y;for(let t=0;t<i.length;t++){const s=i[t].clientX,r=i[t].clientY,a=Math.floor(s-o)/mainM.scaleWidth,h=Math.floor(r-n)/mainM.scaleHeight,c=this.getDiobUnderFinger(s,r),u=i[t].identifier;if(c||this.handleZoneTouch(a,h,u),"function"==typeof VYLO.Client.onTouchBegin&&VYLO.Client.onTouchBegin(c,l.clamp(s,0,this.windowSize.width),l.clamp(r,0,this.windowSize.height),u),c){this.isTracking(c)||this.track(c);const e=this.getTrackerObject(c);if("function"==typeof c.onTouchBegin){let t,e;e="Interface"===c.baseType?(t=l.clamp(s-c.x,0,c.width),l.clamp(r-c.y,0,c.height)):(VYLO.Client.getPosFromScreen(s,r,this.mapPositionObject),t=l.clamp(this.mapPositionObject.x-c.x,0,c.width),l.clamp(this.mapPositionObject.y-c.y,0,c.height)),c.onTouchBegin(VYLO.Client,t,e,u)}c.touchOpacity!==R.MULTI_TOUCH&&e.trackedTouches.length||e.trackedTouches.push(u),c.isMobileHandlerController&&c.controller.update(a,h,!0)}}e.target.closest(".web_box")||e.target.matches(".web_box")||e.preventDefault()}handleEnd(s){const o=s.changedTouches;for(let t=0;t<o.length;t++){var n=o[t].clientX,r=o[t].clientY,a=this.getDiobUnderFinger(n,r),h=o[t].identifier;let e,i;if(this.handleZoneRelease(h),"function"==typeof VYLO.Client.onTouchFinish&&VYLO.Client.onTouchFinish(a,l.clamp(n,0,this.windowSize.width),l.clamp(r,0,this.windowSize.height),h),a){this.isTracking(a)||this.track(a);const s=this.getTrackerObject(a);"function"==typeof a.onTouchFinish&&(i="Interface"===a.baseType?(e=l.clamp(n-a.x,0,a.width),l.clamp(r-a.y,0,a.height)):(VYLO.Client.getPosFromScreen(n,r,this.mapPositionObject),e=l.clamp(this.mapPositionObject.x-a.x,0,a.width),l.clamp(this.mapPositionObject.y-a.y,0,a.height)),a.touchOpacity===R.MULTI_TOUCH||s.trackedTouches.includes(h))&&a.onTouchFinish(VYLO.Client,e,i,h)}for(let t=this.touchedInstances.length-1;0<=t;t--){const o=this.touchedInstances[t];this.isTracking(o)||this.track(o);var c=this.getTrackerObject(o);if(c.trackedTouches.includes(h)){if(c.trackedTouches.splice(c.trackedTouches.indexOf(h),1),"function"==typeof o.onTouchTerminate&&(i="Interface"===o.baseType?(e=l.clamp(n-o.x,0,o.width),l.clamp(r-o.y,0,o.height)):(VYLO.Client.getPosFromScreen(n,r,this.mapPositionObject),e=l.clamp(this.mapPositionObject.x-o.x,0,o.width),l.clamp(this.mapPositionObject.y-o.y,0,o.height)),o.onTouchTerminate(VYLO.Client,e,i,h)),c.slidOff&&(c.slidOff=!1),o.isMobileHandlerController){const s=o;c.trackedTouches.length||s.controller.release()}c.trackedTouches.length||this.touchedInstances.splice(t,1)}}}}handleCancel(t){this.handleEnd(t),"function"==typeof VYLO.Client.onTouchAbort&&VYLO.Client.onTouchAbort();for(let t=this.touchedInstances.length-1;0<=t;t--){var e=this.touchedInstances[t];this.getTrackerObject(e).trackedTouches=[],this.touchedInstances.splice(t,1)}}handleMove(s){const o=s.changedTouches,n=document.getElementById("game_body").getBoundingClientRect(),r=n.x,a=n.y;for(let i=0;i<o.length;i++){const n=o[i].clientX,h=o[i].clientY,c=Math.floor(n-r)/mainM.scaleWidth,u=Math.floor(h-a)/mainM.scaleHeight,p=this.getDiobUnderFinger(n,h),g=o[i].identifier;let t,e;if(this.handleZoneMove(c,u,g),"function"==typeof VYLO.Client.onTouchMoveUpdate&&VYLO.Client.onTouchMoveUpdate(p,l.clamp(n,0,this.windowSize.width),l.clamp(h,0,this.windowSize.height),g),p){this.isTracking(p)||this.track(p);const s=this.getTrackerObject(p);"function"==typeof p.onTouchMoveUpdate&&(e="Interface"===p.baseType?(t=l.clamp(n-p.x,0,p.width),l.clamp(h-p.y,0,p.height)):(VYLO.Client.getPosFromScreen(n,h,this.mapPositionObject),t=l.clamp(this.mapPositionObject.x-p.x,0,p.width),l.clamp(this.mapPositionObject.y-p.y,0,p.height)),p.touchOpacity===R.MULTI_TOUCH||s.trackedTouches.includes(g))&&p.onTouchMoveUpdate(VYLO.Client,t,e,g)}for(const s of this.touchedInstances){this.isTracking(s)||this.track(s);const o=this.getTrackerObject(s);o.trackedTouches.includes(g)&&(s===p||o.slidOff||"function"==typeof s.onTouchSlideEnd&&(o.slidOff=!0,e="Interface"===s.baseType?(t=l.clamp(n-s.x,0,s.width),l.clamp(h-s.y,0,s.height)):(VYLO.Client.getPosFromScreen(n,h,this.mapPositionObject),t=l.clamp(this.mapPositionObject.x-s.x,0,s.width),l.clamp(this.mapPositionObject.y-s.y,0,s.height)),s.onTouchSlideEnd(VYLO.Client,t,e,g)),s.isMobileHandlerController)&&s.controller.update(c,u)}}}}const L=new R;var S=e.g;export{S as MobileHandler};